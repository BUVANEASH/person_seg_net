tflite_convert \
--output_file=mobilenetv2_deeplabv3_BCE_ACC_IOU_divide_1_sigmoid_256_train_person_Q.pb \
--graph_def_file=mobilenetv2_deeplabv3_BCE_ACC_IOU_divide_1_sigmoid_256_train_person.pb \
--output_format=TFLITE \
--inference_type=FLOAT \
--inference_input_type=FLOAT \
--input_arrays=input_layer \
--input_shapes=1,256,256,3 \
--output_arrays=output_layer/Sigmoid \
--post_training_quantize \
--allow_custom_ops

tflite_convert \
--output_file=sample_tf.tflite \
--graph_def_file=fast_scnn_BCE_ACC_IOU_1_sigmoid_768.pb \
--output_format=TFLITE \
--inference_type=FLOAT \
--inference_input_type=FLOAT \
--input_arrays='input_layer' \
--input_shapes=1,768,768,3 \
--output_arrays='output_layer/Sigmoid' \
--post_training_quantize \
--allow_custom_ops

toco \
--output_file=mobilenetv2_Linknet_BCE_ACC_IOU_divide_1_sigmoid_512_train_matte_Q.tflite \
--graph_def_file=mobilenetv2_Linknet_BCE_ACC_IOU_divide_1_sigmoid_512_train_matte.pb \
--output_format=TFLITE \
--inference_type=FLOAT \
--inference_input_type=FLOAT \
--input_arrays=input_1 \
--input_shapes=1,512,512,3 \
--output_arrays=sigmoid/Sigmoid \
--post_training_quantize \
--allow_custom_ops

toco \
--output_file=/media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_deeplabv3_BCE_ACC_IOU_divide_1_sigmoid_256_train_person_Q.pb \
--keras_model_file=/media/new_hdd2/seg_net/results/Models/mobilenetv2_deeplabv3_BCE_ACC_IOU_divide_1_sigmoid_256_train_person.hdf5 \
--output_format=TFLITE \
--inference_type=FLOAT \
--inference_input_type=FLOAT \
--input_arrays=input_layer \
--input_shapes=1,256,256,3 \
--output_arrays=output_layer/Sigmoid \
--post_training_quantize \
--allow_custom_ops

bazel-bin/tensorflow/tools/graph_transforms/transform_graph \
--in_graph=/media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_Linknet_BCE_ACC_IOU_divide_1_sigmoid_512_train_matte.pb \
--out_graph=/media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_Linknet_BCE_ACC_IOU_divide_1_sigmoid_512_train_matte_opt.pb \
--inputs='input_1' \
--outputs='sigmoid/Sigmoid' \
--transforms='
  strip_unused_nodes
  remove_nodes(op=Identity, op=CheckNumerics)
  fold_constants(ignore_errors=true)
  fold_batch_norms'
  


bazel-bin/tensorflow/tools/graph_transforms/transform_graph \
--in_graph=/media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_Linknet_BCE_ACC_IOU_divide_1_sigmoid_512_train_matte.pb \
--out_graph=/media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_Linknet_BCE_ACC_IOU_divide_1_sigmoid_512_train_matte_Qotp.pb \
--inputs='input_1' \
--outputs='sigmoid/Sigmoid' \
--transforms='
  add_default_attributes
  strip_unused_nodes
  remove_nodes(op=Identity, op=CheckNumerics)
  fold_constants(ignore_errors=true)
  fold_batch_norms
  quantize_weights
  quantize_nodes
  strip_unused_nodes
  sort_by_execution_order'


bazel-bin/tensorflow/lite/tools/benchmark/benchmark_model \
  --graph=/media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_GUnet_BCE_ACC_IOU_divide_1_sigmoid_256_train_matte.tflite \
  --num_threads=1

bazel-bin/tensorflow/tools/benchmark/benchmark_model \
  --graph=/media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_GUnet_BCE_ACC_IOU_divide_1_sigmoid_256_train_matte.pb \
  --input_layer="input_1:0" \
  --input_layer_shape="1,256,256,3" \
  --input_layer_type="float" \
  --output_layer="sigmoid/Sigmoid:0" \
  --num_threads=1



freeze_graph \
--input_graph=/media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_deeplabv3_BCE_ACC_IOU_divide_1_sigmoid_256_train_person.pb \
--output_graph=/media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_deeplabv3_BCE_ACC_IOU_divide_1_sigmoid_256_train_person_.pb \
--output_node_names='output_layer/Sigmoid' \
--clear_devices









python3 keras_to_tf.py --input_model=/media/new_hdd2/seg_net/results/Models/Models/resnet50_Unet_BCE_ACC_IOU_1_sigmoid_768.hdf5 \
--output_model=/media/new_hdd2/seg_net/results/Models/Models/resnet50_Unet_BCE_ACC_IOU_1_sigmoid_768_quantized.pb \
--quantize=True

tflite_convert \
  --output_file=/media/new_hdd2/seg_net/results/Models/Models/resnet50_Unet_BCE_ACC_IOU_1_sigmoid_768_quantized.tflite \
  --keras_model_file=/media/new_hdd2/seg_net/results/Models/Models/resnet50_Unet_BCE_ACC_IOU_1_sigmoid_768.hdf5




+++++++++++++++++++++++++++++++++++++++++++++++++


(1) Build for your specific platform, e.g.:

bazel build -c opt \
  --config=android_arm \
  --cxxopt='--std=c++11' \
  tensorflow/lite/tools/benchmark:benchmark_model

(2) Connect your phone. Push the binary to your phone with adb push (make the directory if required):

adb push bazel-bin/tensorflow/lite/tools/benchmark/benchmark_model /data/local/tmp

(3) Make the binary executable.

adb shell chmod +x /data/local/tmp/benchmark_model

(4) Push the compute graph that you need to test. For example:

adb push /media/new_hdd2/seg_net/results/Models/GraphModels/mobilenetv2_GUnet_BCE_ACC_IOU_divide_1_sigmoid_256_train_matte.tflite /data/local/tmp

(5) Run the benchmark. For example:

adb shell /data/local/tmp/benchmark_model \
  --graph=/data/local/tmp/mobilenetv2_GUnet_BCE_ACC_IOU_divide_1_sigmoid_256_train_matte.tflite \
  --num_threads=4


